const char depthpass_lua[] = "local depthWriteMat = CreateMaterial( \"egsm/depthmat\", \"DepthWrite\", {\n""  [\"$no_fullbright\"] = \"1\",\n""  [\"$color_depth\"] = \"1\",\n""  [\"$alpha_test\"] = \"0\",\n""} )\n""\n""local bDepthPass = false\n""local halo = {}\n""local render = render\n""\n""MaterialOverride 	   =  	MaterialOverride or render.MaterialOverride\n""BrushMaterialOverride  = 	BrushMaterialOverride or render.BrushMaterialOverride \n""WorldMaterialOverride  = 	WorldMaterialOverride or render.WorldMaterialOverride \n""ModelMaterialOverride  = 	ModelMaterialOverride or render.ModelMaterialOverride \n""\n""local MaterialOverride = MaterialOverride\n""local BrushMaterialOverride = BrushMaterialOverride\n""local WorldMaterialOverride = WorldMaterialOverride\n""local ModelMaterialOverride = ModelMaterialOverride\n""\n""function render.MaterialOverride(m)\n""	if bDepthPass then return end\n""	MaterialOverride(m)\n""end\n""\n""function render.BrushMaterialOverride(m)\n""	if bDepthPass then return end\n""	BrushMaterialOverride(m)\n""end\n""\n""function render.WorldMaterialOverride(m)\n""	if bDepthPass then return end\n""	WorldMaterialOverride(m)\n""end\n""function render.ModelMaterialOverride(m)\n""	if bDepthPass then return end\n""	ModelMaterialOverride(m)\n""end\n""\n""local function dummyFn() end\n""\n""local PushRenderTarget  = 	render.PushRenderTarget\n""local PopRenderTarget  = 	render.PopRenderTarget\n""local rClear  = render.Clear\n""local depthRT = render.GetResolvedFullFrameDepth()\n""local hRender = dummyFn\n""local BeginDepthPass = shaderlib.BeginDepthPass\n""local EndDepthPass = shaderlib.EndDepthPass\n""local RenderView = render.RenderView\n""local rClearDepth = render.ClearDepth\n""\n""local function PreDrawEffectsHK() \n""	if bDepthPass then return end\n""	bDepthPass = true\n""	\n""	halo.Render = dummyFn\n""	\n""	MaterialOverride( depthWriteMat )\n""	BrushMaterialOverride( depthWriteMat )\n""	WorldMaterialOverride( depthWriteMat )\n""	ModelMaterialOverride( depthWriteMat )\n""	\n""	BeginDepthPass()\n""		rClear(0,0,0,0) \n""		\n""		rClear(0,0,0,0)\n""		\n""		rClear(0,0,0,0) \n""\n""		RenderView()\n""	EndDepthPass()\n""\n""	MaterialOverride()\n""	BrushMaterialOverride()\n""	WorldMaterialOverride()\n""	ModelMaterialOverride()\n""	\n""	halo.Render = hRender\n""	bDepthPass = false\n""end\n""\n""local zero_vec = Vector(0,0,0)\n""local min,max = zero_vec, zero_vec\n""\n""function shaderlib.__INIT()\n""	halo = halo\n""	hRender = halo.Render\n""\n""	hook.Add(\"PreDrawViewModel\", \"!!!EGSM_ImTooLazy\", function() if bDepthPass then rClearDepth() end end)	\n""	hook.Add(\"NeedsDepthPass\", \"!!!EGSM_ImTooLazy\", PreDrawEffectsHK)\n""	\n""	hook.Add(\"PostDraw2DSkyBox\", \"!!!EGSM_ImTooLazy\", function()\n""		local rt = render.GetRenderTarget()\n""		if !rt or rt:GetName() != \"egsm_skyboxrt\" \n""		then  \n""			return\n""		end\n""		cam.Start3D( zero_vec, EyeAngles() )\n""		min,max = game.GetWorld():GetModelBounds()\n""	\n""		render.SetMaterial( depthWriteMat )\n""		\n""		render.DrawBox( zero_vec, angle_zero, max, min, color_white )\n""		cam.End3D()\n""	end)	\n""end\n";